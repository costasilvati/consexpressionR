#' Execute knowSeq differential Expression analyse
#'
#' @param countMatrix #' @param countMatrix original table count or abundance data
#' @param groupName replicate and treatment by samples
#' @param numberReplic number of replicate (technical or biological) by sample
#' @param filterId The attribute used as filter to return the rest of the attributes.
#' @param notSapiens A boolean value that indicates if the user wants the human annotation or another annotation available in BiomaRt. The possible not human dataset can be consulted by calling the following function: biomaRt::listDatasets(useMart("ensembl")).
#' @return extracted results from KnowSeq (generated by KnowSeq::DEGsExtraction() function)
#' @export
#'
#' @examples
#' df <- as.matrix(readCountFile(tableCountPath="data/table_count_df.csv",split=","))
#' groupNameModel = c("BM","JJ")
#' numberReplicsModel = 3
#' designExperimentModel <- rep(groupNameModel, each = numberReplicModel)
#' toolResult <- NULL
#' toolResult$knowSeq <- runKnowSeq(countMatrix = df,
#'                                groupName = groupNameModel,
#'                                numberReplic = numberReplicsModel)
runKnowSeq <- function(countMatrix,
                       groupName,
                       numberReplic,
                       filterId="ensembl_gene_id",
                       notSapiens = FALSE){
  designExperiment <- rep(groupName, each = numberReplic)
  myAnnotation <- KnowSeq::getGenesAnnotation(row.names(countMatrix),
                                     filter=filterId,
                                     notHSapiens = notSapiens)
  designExperiment <- rep(groupName, each=numberReplic)
  knowSeq <- KnowSeq::DEGsExtraction(countMatrix,
                            labels = designExperiment)
  return(knowSeq$DEG_Results$DEGs_Table)
}
