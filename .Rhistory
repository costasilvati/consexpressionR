result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
if(typeof(countMatrix) != "double"){
# SAMSeq only count data
print("**** SAMSeq run CANCELLED, enabled for count data only.")
result$samseq<-runSamSeq(countMatrix,
numberReplics,
designExperiment)
}
result$bayseq<-runBaySeq(countMatrix,
designExperiment)
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="table_count.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
View(teste$desq2)
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(result$desq2)
result$desq2
summary(result$desq2)
res05 <- results(result$desq2, alpha=0.05)
res05 <- results(result$desq2, alpha=0.05)
res05 <- DESeq2::results(result$desq2, alpha=0.05)
res05 <- DESeq2::results(result$desq2, alpha=0.05)
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::resultsNames(teste$desq2)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::resultsNames(res)
DESeq2::summary(teste$desq2)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::summary(teste$desq2)
DESEq2::plotCounts(result$desq2, gene=which.min(res$padj), intgroup="0b")
DESeq2::plotCounts(result$desq2, gene=which.min(res$padj), intgroup="0b")
DESeq2::plotCounts(result$desq2, gene=which.min(result$desq2$padj), intgroup="0b")
devtools::load_all()
DESeq2::plotCounts(result$desq2, gene=which.min(result$desq2$padj), intgroup="0b")
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
colnames(countMatrix)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
countMatrix <- readCountFile(tableCountPath,
sepCharacter)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
resultNames(teste$desq2)
resultsNames(teste$desq2)
DESeq2::resultsNames(teste$desq2)
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistoDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste
str(teste)
teste$edger$logFC
teste$edger$logFC[1]
teste$edger$logFC[2]
teste$edger$logFC[3]
View(teste$edger)
teste$edger$logFC['TR12426|c0_g2_i6']
teste$edger$logFC('TR12426|c0_g2_i6')
teste$edger['TR12426|c0_g2_i6']
teste$edger[,'TR12426|c0_g2_i6']
devtools::load_all()
edgerDe <- dplyr::select_if(teste$edger$logFC >= 2.0 || teste$edger$logFC <= 2.0)
dplyr::select_if()?
;
?dplyr::select_if()
edgerDe <- dplyr::select_if(teste$edger, teste$edger$logFC >= 2.0 || teste$edger$logFC <= 2.0)
rangeLfc <- c(-2 : 2)
data_frame_mod <- subset(teste$edger,
logFC %in% c(-2, 2,-2.5, 2.5 ))
teste$edger$logFC
rangeLfc
rangeLfc <- c(-2.0 : 2.1)
rangeLfc
rangeLfc <- c(-2.0 : -7.0)
data_frame_mod <- subset(teste$edger,
logFC %in% rangeLfc)
rangeLfc <- c(-2.0 : -7.0)
rangeLfc
rangeLfc <- c(-2.0 : -7L)
rangeLfc
rangeLfc <- c(2L : 7L)
rangeLfc
rangeLfc <- c(-2.0+0i : -7.0+0i)
rangeLfc
class(rangeLfc)
data_frame_mod <- dplyr::filter(teste$edger,
logFC >= 2.0)
data_frame_mod <- dplyr::filter(teste$edger, (logFC <= -2.0 | logFC >= 2.0))
data_frame_mod
View(data_frame_mod)
data_frame_mod <- dplyr::filter(teste$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
edger <- teste$edger
edegrDe <- dplyr::filter(teste$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
remove(data_frame_mod)
deTool <- teste
consexpression2::writeResults(edgerDe,"edgeRDe", "\t")
consexpression2::writeResults(edegrDe,"edgeRDe", "\t")
devtools::load_all()
consexpression2::writeResults(edegrDe,"edgeRDe", "\t")
consexpression2::writeResults(edegrDe,"edgeRDe")
ebseq <- teste$ebseq
head(ebseq)
View(ebseq)
View(ebseq)
colnames(ebseq)
eb <- data.frame(ebseq, row.names = 1)
ebseq
consexpression2::writeResults(ebseq,"EBSeq")
class(ebseq)
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL)
View(ebseqDataFrame)
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames(c("expression")))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames("expression"))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames = c("expression"))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL)
remove(ebseqDataFrame)
ebseqDf <- as.data.frame(deTool$ebseq, row.names = NULL)
is.null(ebseq)
ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
View(ebseqDe)
View(edegrDe)
deList <- NULL
deList <- NULL
deList$edgerDe <- dplyr::filter(deTool$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
consexpression2::writeResults(deList$edgerDe,"edgerDE")
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
consexpression2::writeResults(deList$ebseqDe,"EBSeqDE")
remove(edegrDe)
remove(ebseqDe)
remove(edger)
remove(ebseq)
deList$limma <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
deList$limmaDe <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
remove(deList$limma)
deList <- NULL
deList$edgerDe <- dplyr::filter(deTool$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
deList$limmaDe <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
ebseqDf <- as.data.frame(deTool$ebseq, row.names = NULL)
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
View(ebseqDf)
deList$ebseqDe <- dplyr::filter(ebseqDf, deTool$ebseq == "DE")
consexpression2::writeResults(deList$limmaDe,"limmaDE")
View(deTool$noiseq)
deList$noiseqDe <- dplyr::filter(deTool$noiseq, (prob >= 0.95))
consexpression2::writeResults(deList$noiseqDe,"NOISeqDE")
!is.null(deTool$desq2)
is.null(deTool$desq2)
deTool$desq2$log2FoldChange
deList$deseq2 <- dplyr::filter(deTool$desq2, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
deseq2Df <- as.data.frame(deTool$deseq2, row.names = NULL)
t <- DESeq2::resultsNames(deTool$desq2)
t <- DESeq2::resultsNames(deTool$desq2)
t
DESeq2::resultsNames(deTool$desq2)
t <- DESeq2::lfcShrink(deTool$desq2, coef = 2)
deTool$desq2$baseMean
resOrdered <- res[order(deTool$desq2$pvalue),]
resOrdered <- deTool$desq2[order(deTool$desq2$pvalue),]
deseq2Df <- as.data.frame(resOrdered)
deList$deseq2 <- dplyr::filter(desq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
deList$deseq2 <- dplyr::filter(deseq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
consexpression2::writeResults(deList$deseq2,"DESeq2DE")
deList$deseq2
deList$deseq2De <- dplyr::filter(deseq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
set.seed(20190708)
genes <- paste("gene",1:1000,sep="")
x <- list(
A = sample(genes,300),
B = sample(genes,525),
C = sample(genes,440),
D = sample(genes,350)
)
if (!require(devtools)) install.packages("devtools")
devtools::install_github("yanlinlin82/ggvenn")
library(ggvenn)
ggvenn(
x,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
View(x)
View(x$A)
x$A
xDe$A<- row.names(teste$edger)
xDe$A<- row.names(teste$edger)
xDe <- NULL
xDe$A<- row.names(teste$edger)
remove(xDE)
xDe$D <- row.names(teste$ebseq)
remove(xDe)
xDe <- NULL
xDe <- NULL
xDe$edgeR <- row.names(deList$edgerDe)
xDe$limma <- row.names(deList$limmaDe)
xDe$NOISeq <- row.names(deList$noiseqDe)
xDe$ebSeq <- row.names(deList$ebseqDe)
xDe$DESeq2 <- row.names(deList$deseq2De)
ggvenn(
xDe,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4)
library("ggVennDiagram")
install.packages("ggVenDiagram")
install.packages("ggVenDiagram", force=TRUE
)
library(VennDiagram)
venn.diagram(xDe, filename = "venn-4-dimensions.png")
# Helper function to display Venn diagram
display_venn <- function(x, ...){
library(VennDiagram)
grid.newpage()
venn_object <- venn.diagram(x, filename = NULL, ...)
grid.draw(venn_object)
}
display_venn(
x,
category.names = c("Set 1" , "Set 2 " , "Set 3", "Set 4"),
# Circles
lwd = 2,
lty = 'blank',
fill = c("#999999", "#E69F00", "#56B4E9", "#009E73"),
# Numbers
cex = .9,
fontface = "italic",
# Set names
cat.cex = 1,
cat.fontface = "bold",
cat.default.pos = "outer",
cat.dist = c(0.055, 0.055, 0.1, 0.1)
)
display_venn(
xDe,
category.names = c("edgeR" , "limma " , "NOISeq", "ebSeq", "DESeq2"),
# Circles
lwd = 2,
lty = 'blank',
fill = c("#999999", "#E69F00", "#56B4E9", "#009E73", "#001E73"),
# Numbers
cex = .9,
fontface = "italic",
# Set names
cat.cex = 1,
cat.fontface = "bold",
cat.default.pos = "outer",
cat.dist = c(0.055, 0.055, 0.1, 0.1)
)
ggvenn(
xDe,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "#CD534C00"),
stroke_size = 0.5, set_name_size = 4)
ggvenn(
xDe,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF", "#CD534C00"),
stroke_size = 0.5, set_name_size = 5)
library(ggvenn)
ggvenn(
xDe,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.2, set_name_size = 4)
#-------- venn package ---------------------------
install.packages("VennDiagram")
install.packages("VennDiagram")
#-------- venn package ---------------------------
install.packages("venn")
venn::venn(5)
venn::venn(4)
venn::venn(6)
venn::venn(6, elipse=TRUE)
venn::venn(6, elipse=TRUE)
venn::venn(6, ellipse=TRUE)
venn::venn(6, ellipse=TRUE)
venn::venn(6, ellipse=TRUE)
venn(6, ellipse=TRUE)
venn(6, ellipse=TRUE)
library("venn")
venn(5, ellipse = TRUE)
venn(xDE, ellipse = TRUE)
venn(xDE, ellipse = TRUE, ilabels = TRUE, zcolor = "style")
venn(5, ellipse = TRUE, ilabels = TRUE, zcolor = "style")
venn(5, ellipse = FALSE, ilabels = TRUE, zcolor = "style")
set.seed(12345)
x <- as.data.frame(matrix(sample(0:1, 150, replace = TRUE), ncol = 5))
venn(x, ilabels = "counts")
View(x)
venn(xDe, ilabels = "counts", ggplot = TRUE)
library("ggplot2")
venn(xDe, ilabels = "counts", ggplot = TRUE)
venn(xDe, ggplot = TRUE)
venn(xDe)
venn(xDe, zcolor = "style")
venn(xDe, zcolor = "style", ellipse = TRUE)
venn(xDe, zcolor = c("#999999", "#E69F00", "#56B4E9", "#009E73", "#001E73"), ellipse = TRUE)
venn(xDe, borders= FALSE,zcolor = c("#999999", "#E69F00", "#56B4E9", "#009E73", "#001E73"), ellipse = TRUE)
venn(xDe, borders= FALSE,zcolor = "style", ellipse = TRUE)
venn(xDe, borders = TRUE, zcolor = "style", ellipse = TRUE)
venn(xDe, borders = FALSE, zcolor = "style", ellipse = TRUE)
remove(x)
vennObj <- venn(xDe, borders = FALSE, zcolor = "style", ellipse = TRUE)
