designExperiment <- names(countMatrix)
# Design experiment
designExperiment <- names(countMatrix)
designExperiment <- colnames(countMatrix)
pathDirRun <- "gonoda"
pathRuns<- "gonoda_report.txt"
pathFile <-"/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"
fileKallisto <- "abundance.tsv"
result$deseq2 <- runDeseq2 (countMatrix,
designExperiment,
numberReplics,
pathReportRuns = pathRuns,
pathReportFile = pathReportRuns,
dirRuns = pathDirRun,
fileKallistoAbundance = fileKallisto)
# Command to load current version of package
devtools::load_all()
result$deseq2 <- runDeseq2 (countMatrix,
designExperiment,
numberReplics,
pathReportRuns = pathRuns,
pathReportFile = pathReportRuns,
dirRuns = pathDirRun,
fileKallistoAbundance = fileKallisto)
# Command to load current version of package
devtools::load_all()
result$deseq2 <- runDeseq2 (countMatrix,
designExperiment,
numberReplics,
pathReportRuns = pathRuns,
pathReportFile = pathReportRuns,
dirRuns = pathDirRun,
fileKallistoAbundance = fileKallisto)
# Command to load current version of package
devtools::load_all()
result$deseq2 <- runDeseq2 (countMatrix,
designExperiment,
pathReportRuns = pathRuns,
pathReportFile = pathReportRuns,
dirRuns = pathDirRun,
fileKallistoAbundance = fileKallisto)
files
# Command to load current version of package
devtools::load_all()
result$deseq2 <- runDeseq2 (countMatrix,
designExperiment,
pathReportRuns = pathRuns,
pathReportFile = pathReportRuns,
dirRuns = pathDirRun,
fileKallistoAbundance = fileKallisto)
pathRuns<- "gonoda_report.txt"
runDeseq2(countMatrix,designExperiment,""/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"","gonoda_report.txt", "gonoda", "abundance.tsv")
runDeseq2(countMatrix,designExperiment,"/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B","gonoda_report.txt", "gonoda", "abundance.tsv")
runDeseq2(countMatrix,designExperiment,"gonoda_report.txt", "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B","gonoda", "abundance.tsv")
View(countMatrix)
pathSubDirRun <- "gonoda"
pathReport<- "gonoda_report.txt"
pathDir <-"/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"
fileKallisto <- "abundance.tsv"
dataConsexpression <- consexpression2(numberReplics =  3,
groupName = c("0b", "1b"),
tableCountPath = "tablecount.csv",
sepCharacter="\t",
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
devtools::load_all()
dataConsexpression <- consexpression2(numberReplics =  3,
groupName = c("0b", "1b"),
tableCountPath = "tablecount.csv",
sepCharacter="\t",
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
devtools::load_all()
dataConsexpression <- consexpression2(numberReplics =  3,
groupName = c("0b", "1b"),
tableCountPath = "tablecount.csv",
sepCharacter="\t",
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
numberReplics =  3
groupName = c("0b", "1b")
tableCountPath = "tablecount.csv"
sepCharacter="\t"
kallistoReport = "gonoda_report.txt"
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"
kallistoSubDir = "gonoda"
kallistoOut = "abundance.tsv"
countMatrix <- readCountFile(tableCountPath,
sepCharacter)
designExperiment <- rep(groupName,
each = numberReplics)
result <- NULL
result$edger<-runEdger(countMatrix,
numberReplics,
designExperiment)
result$limma<-runLimma(countMatrix,
numberReplics,
designExperiment,
methodNorm,
methodAdjPvalue,
numberTopTable)
methodNorm = "TMM"
methodAdjPvalue = "BH"
numberTopTable = 1000000
result$limma<-runLimma(countMatrix,
numberReplics,
designExperiment,
methodNorm,
methodAdjPvalue,
numberTopTable)
result$noiseq<-runNoiSeq(countMatrix,
designExperiment)
result$ebseq <- runEbseq(countMatrix,
designExperiment)
printResults=FALSE
kallistoReport = "gonoda_report.txt"
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"
kallistoSubDir = "gonoda"
kallistoOut = "abundance.tsv"
designExperimentDeseq2 <- colnames(countMatrix)
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
kallistoDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B"
remove(kallistiDir)
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
if(typeof(countMatrix) != "double"){
# SAMSeq only count data
print("**** SAMSeq run CANCELLED, enabled for count data only.")
result$samseq<-runSamSeq(countMatrix,
numberReplics,
designExperiment)
}
result$bayseq<-runBaySeq(countMatrix,
designExperiment)
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="table_count.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
View(teste$desq2)
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
result$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(result$desq2)
result$desq2
summary(result$desq2)
res05 <- results(result$desq2, alpha=0.05)
res05 <- results(result$desq2, alpha=0.05)
res05 <- DESeq2::results(result$desq2, alpha=0.05)
res05 <- DESeq2::results(result$desq2, alpha=0.05)
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::resultsNames(teste$desq2)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::resultsNames(res)
DESeq2::summary(teste$desq2)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
DESeq2::summary(teste$desq2)
DESEq2::plotCounts(result$desq2, gene=which.min(res$padj), intgroup="0b")
DESeq2::plotCounts(result$desq2, gene=which.min(res$padj), intgroup="0b")
DESeq2::plotCounts(result$desq2, gene=which.min(result$desq2$padj), intgroup="0b")
devtools::load_all()
DESeq2::plotCounts(result$desq2, gene=which.min(result$desq2$padj), intgroup="0b")
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
colnames(countMatrix)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
View(countMatrix)
countMatrix <- readCountFile(tableCountPath,
sepCharacter)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
devtools::load_all()
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
teste$desq2 <- runDeseq2(countMatrix,groupName,
designExperimentDeseq2,
kallistoReport,
kallistoDir,
kallistoSubDir,
kallistoOut)
resultNames(teste$desq2)
resultsNames(teste$desq2)
DESeq2::resultsNames(teste$desq2)
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
devtools::load_all()
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistiDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste <- consexpression2 (numberReplics = 3,
groupName = c("0b","1b"),
tableCountPath ="tablecount.csv",
sepCharacter="\t",
experimentName="genericExperiment",
outDirPath="consexpression2_results/",
methodNorm = "TMM",
methodAdjPvalue = "BH",
numberTopTable = 1000000,
printResults=FALSE,
kallistoReport = "gonoda_report.txt",
kallistoDir = "/Users/julianacostasilva/Library/CloudStorage/OneDrive-Pessoal/ProjetoDoutorado/bioconvergencia/reads_RNApa/kallisto_quant_align_apa_1B_0B",
kallistoSubDir = "gonoda",
kallistoOut = "abundance.tsv")
teste
str(teste)
teste$edger$logFC
teste$edger$logFC[1]
teste$edger$logFC[2]
teste$edger$logFC[3]
View(teste$edger)
teste$edger$logFC['TR12426|c0_g2_i6']
teste$edger$logFC('TR12426|c0_g2_i6')
teste$edger['TR12426|c0_g2_i6']
teste$edger[,'TR12426|c0_g2_i6']
devtools::load_all()
edgerDe <- dplyr::select_if(teste$edger$logFC >= 2.0 || teste$edger$logFC <= 2.0)
dplyr::select_if()?
;
?dplyr::select_if()
edgerDe <- dplyr::select_if(teste$edger, teste$edger$logFC >= 2.0 || teste$edger$logFC <= 2.0)
rangeLfc <- c(-2 : 2)
data_frame_mod <- subset(teste$edger,
logFC %in% c(-2, 2,-2.5, 2.5 ))
teste$edger$logFC
rangeLfc
rangeLfc <- c(-2.0 : 2.1)
rangeLfc
rangeLfc <- c(-2.0 : -7.0)
data_frame_mod <- subset(teste$edger,
logFC %in% rangeLfc)
rangeLfc <- c(-2.0 : -7.0)
rangeLfc
rangeLfc <- c(-2.0 : -7L)
rangeLfc
rangeLfc <- c(2L : 7L)
rangeLfc
rangeLfc <- c(-2.0+0i : -7.0+0i)
rangeLfc
class(rangeLfc)
data_frame_mod <- dplyr::filter(teste$edger,
logFC >= 2.0)
data_frame_mod <- dplyr::filter(teste$edger, (logFC <= -2.0 | logFC >= 2.0))
data_frame_mod
View(data_frame_mod)
data_frame_mod <- dplyr::filter(teste$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
edger <- teste$edger
edegrDe <- dplyr::filter(teste$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
remove(data_frame_mod)
deTool <- teste
consexpression2::writeResults(edgerDe,"edgeRDe", "\t")
consexpression2::writeResults(edegrDe,"edgeRDe", "\t")
devtools::load_all()
consexpression2::writeResults(edegrDe,"edgeRDe", "\t")
consexpression2::writeResults(edegrDe,"edgeRDe")
ebseq <- teste$ebseq
head(ebseq)
View(ebseq)
View(ebseq)
colnames(ebseq)
eb <- data.frame(ebseq, row.names = 1)
ebseq
consexpression2::writeResults(ebseq,"EBSeq")
class(ebseq)
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL)
View(ebseqDataFrame)
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames(c("expression")))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames("expression"))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL, colnames = c("expression"))
ebseqDataFrame <- as.data.frame(ebseq, row.names = NULL)
remove(ebseqDataFrame)
ebseqDf <- as.data.frame(deTool$ebseq, row.names = NULL)
is.null(ebseq)
ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
View(ebseqDe)
View(edegrDe)
deList <- NULL
deList <- NULL
deList$edgerDe <- dplyr::filter(deTool$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
consexpression2::writeResults(deList$edgerDe,"edgerDE")
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
consexpression2::writeResults(deList$ebseqDe,"EBSeqDE")
remove(edegrDe)
remove(ebseqDe)
remove(edger)
remove(ebseq)
deList$limma <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
deList$limmaDe <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
remove(deList$limma)
deList <- NULL
deList$edgerDe <- dplyr::filter(deTool$edger, ((logFC <= -2.0 | logFC >= 2.0) & (PValue >= 0.05)))
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
deList$limmaDe <- dplyr::filter(deTool$limma, ((logFC <= -2.0 | logFC >= 2.0) & (P.Value >= 0.05)))
ebseqDf <- as.data.frame(deTool$ebseq, row.names = NULL)
deList$ebseqDe <- dplyr::filter(ebseqDf, ebseq == "DE")
View(ebseqDf)
deList$ebseqDe <- dplyr::filter(ebseqDf, deTool$ebseq == "DE")
consexpression2::writeResults(deList$limmaDe,"limmaDE")
View(deTool$noiseq)
deList$noiseqDe <- dplyr::filter(deTool$noiseq, (prob >= 0.95))
consexpression2::writeResults(deList$noiseqDe,"NOISeqDE")
!is.null(deTool$desq2)
is.null(deTool$desq2)
deTool$desq2$log2FoldChange
deList$deseq2 <- dplyr::filter(deTool$desq2, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
deseq2Df <- as.data.frame(deTool$deseq2, row.names = NULL)
t <- DESeq2::resultsNames(deTool$desq2)
t <- DESeq2::resultsNames(deTool$desq2)
t
DESeq2::resultsNames(deTool$desq2)
t <- DESeq2::lfcShrink(deTool$desq2, coef = 2)
deTool$desq2$baseMean
resOrdered <- res[order(deTool$desq2$pvalue),]
resOrdered <- deTool$desq2[order(deTool$desq2$pvalue),]
deseq2Df <- as.data.frame(resOrdered)
deList$deseq2 <- dplyr::filter(desq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
deList$deseq2 <- dplyr::filter(deseq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
consexpression2::writeResults(deList$deseq2,"DESeq2DE")
deList$deseq2
deList$deseq2De <- dplyr::filter(deseq2Df, ((log2FoldChange <= -2.0 | log2FoldChange >= 2.0) & (pvalue >= 0.05)))
